---
layout: single
title: "[DAY-51] React (4)"
categories: [devCourse, TIL]
last_modified_at: 2022-05-30
excerpt: "ğŸ˜ŠTIL : Context API"
header:
  teaser: https://user-images.githubusercontent.com/72294509/171096525-93a3f542-c776-45ce-a1c8-8246a8f7a9a9.png
---

![023](https://user-images.githubusercontent.com/72294509/171096525-93a3f542-c776-45ce-a1c8-8246a8f7a9a9.png){: .align-center}

> ğŸ˜‰ **í—·ê°ˆë ¸ë˜ & ëª°ëë˜ ë¶€ë¶„ë“¤ë§Œ ì •ë¦¬**í•˜ëŠ” ë‚˜ë§Œì˜ TIL<br>
> ğŸ˜¯ ëª¨ë“  ê°•ì˜ ë‚´ìš©ì€ ì ì§€ ì•Šì•„ìš”!

<p class='notice--success'>
	<strong>ì˜¤ëŠ˜ì˜ ì†Œê°ì€?</strong><br>
	Vuexì™€ ë¹„ìŠ·í•œ Context API..<br>
	ì´ ì¹œêµ¬ë„ í—·ê°ˆë¦¬ëŠ”ë° Redux ì–´ë–¡í•˜ì§€..? í—¤í—¤<br>
</p>

<br><br><br>

# [1] Context API

`Component`ëŠ” íŠ¸ë¦¬ êµ¬ì¡°ë¡œ ì´ë£¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤.

ê°œë°œì„ ì§„í–‰í•˜ë‹¤ë³´ë©´ íŠ¸ë¦¬ ë ˆë²¨ì´ ê¹Šì–´ì§€ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ `props`ë¥¼ ë„˜ê²¨ì¤„ ë•Œ íŠ¸ë¦¬ë¥¼ ê³„ì† íƒ€ê³  ë„˜ì–´ê°€ì•¼ í•˜ëŠ” `Prop Drilling` í˜„ìƒì´ ë°œìƒí•©ë‹ˆë‹¤.

<br>

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë„êµ¬ ì¤‘ í•˜ë‚˜ê°€ `Context API`ì…ë‹ˆë‹¤. (ì „ì—­ ìƒíƒœ ê´€ë¦¬)

`Context Provider`ë¡œ ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ê³ , `Context Consumer`ë¡œ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ì•„ ì‚¬ìš©í•©ë‹ˆë‹¤.

```jsx
import { createContext, useContext } from "react";

const TaskContext = createContext();
export const useTasks = () => useContext(TaskContext);
```

í•´ë‹¹ Contextë¥¼ React.createContextë¡œ ë§Œë“¤ì–´ ì‚¬ìš©í•©ë‹ˆë‹¤.

```jsx
{% raw %}
const TaskProvider = ({ children }) => {
  const [tasks, setTasks] = useLocalStorage("TASKS", []);

  const addTask = (content) => {
    setTasks([
      ...tasks,
      {
        id: v4(),
        content,
        complete: false,
      },
    ]);
  };

  const updateTask = (id, status) => {
    setTasks(
      tasks.map((item) =>
        item.id === id ? { ...item, complete: status } : item
      )
    );
  };

  const removeTask = (id) => {
    setTasks(tasks.filter((item) => item.id !== id));
  };

  return (
    <TaskContext.Provider value={{ tasks, addTask, updateTask, removeTask }}>
      {children}
    </TaskContext.Provider>
    // Contextì˜ ë³€í™”ë¥¼ ì•Œë¦¬ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.
    // value propì„ ë°›ì•„ì„œ ì´ ê°’ì„ í•˜ìœ„ì— ìˆëŠ” ì»´í¬ë„ŒíŠ¸ì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.
  );
};

export default TaskProvider;
{% endraw %}
```

ìƒì„±í•œ `TaskContext`ì—ì„œ ì‚¬ìš©í•  `Provider`ì˜ ë‚´ìš©ì„ `Component`í˜•ì‹ìœ¼ë¡œ `return`í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.

<br>

```jsx
// Task.js ì¼ë¶€
const { updateTask, removeTask } = useTasks();
```

í•¨ìˆ˜ ë˜ëŠ” ê°’ì„ êº¼ë‚´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

ë˜í•œ ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¡œ context ê°’ì„ ì§€ì¼œë³´ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
<TaskContext.Consumer>{value}</TaskContext.Consumer>
```

<br><br>

## [1-1] íŠ¹ì§•

`Context`ì˜ ì£¼ëœ ìš©ë„ëŠ” **ë‹¤ì–‘í•œ ë ˆë²¨ì— ë„¤ìŠ¤íŒ…ëœ ë§ì€ ì»´í¬ë„ŒíŠ¸ë“¤ì—ê²Œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒ** ì…ë‹ˆë‹¤.

ë”°ë¼ì„œ **í•´ë‹¹ ìš©ë„ê°€ ê¼­ í•„ìš”í•  ë•Œë§Œ** `Context`**ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.**

<br>

ì™œëƒí•˜ë©´ `Context`ë¥¼ ì‚¬ìš©í•˜ë©´ **ì»´í¬ë„ŒíŠ¸ë¥¼ ì¬ì‚¬ìš©í•˜ê¸°ê°€ ì–´ë ¤ì›Œì§‘ë‹ˆë‹¤.**

`Context consumer`ë¡œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë“¤ì€, `Provider`ë¡œ ì¡°ì‘ë˜ëŠ” ë°ì´í„°ê°€ ë³€ê²½ë  ê²½ìš° **ì „ë¶€ ì¬ë Œë”ë§ ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.**

ì´ ê²½ìš°, `Provider`ì˜ **ë¶€ëª¨ê°€ ë Œë”ë§ ë  ë•Œë§ˆë‹¤ ë¶ˆí•„ìš”í•˜ê²Œ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë“¤ì´ ë‹¤ì‹œ ë Œë”ë§**ë©ë‹ˆë‹¤.

<br><br><br>

# [2] ì»´í¬ë„ŒíŠ¸ ì‹¤ìŠµ

- Upload

```jsx
// index.js
import { useRef, useState } from "react";
import styled from "@emotion/styled";

const UploadContainer = styled.div`
  display: inline-block;
  cursor: pointer;
`;

const Input = styled.input`
  display: none;
`;

const Upload = ({
  children,
  droppable,
  name,
  accept,
  value,
  onChange,
  ...props
}) => {
  const [file, setFile] = useState(value);
  const [dragging, setDragging] = useState(false);
  const inputRef = useRef(null);

  const handleFileChange = (e) => {
    const files = e.target.files;
    const changedFile = files[0];
    setFile(changedFile);
    onChange && onChange(changedFile);
  };

  const handleChooseFile = () => {
    inputRef.current.click();
  };

  const handleDragEnter = (e) => {
    if (!droppable) return;

    e.preventDefault();
    e.stopPropagation();

    if (e.dataTransfer.items && e.dataTransfer.items.length > 0) {
      setDragging(true);
    }
  };

  const handleDragLeave = (e) => {
    if (!droppable) return;

    e.preventDefault();
    e.stopPropagation();

    setDragging(false);
  };

  const handleDragOver = (e) => {
    if (!droppable) return;

    e.preventDefault();
    e.stopPropagation();
  };

  const handleFileDrop = (e) => {
    if (!droppable) return;

    e.preventDefault();
    e.stopPropagation();

    const files = e.dataTransfer.files;
    const changedFile = files[0];
    setFile(changedFile);
    onChange && onChange(changedFile);
    setDragging(false);
  };

  return (
    <UploadContainer
      onClick={handleChooseFile}
      onDrop={handleFileDrop}
      onDragEnter={handleDragEnter}
      onDragLeave={handleDragLeave}
      onDragOver={handleDragOver}
      {...props}
    >
      <Input
        ref={inputRef}
        type="file"
        name={name}
        accept={accept}
        onChange={handleFileChange}
      />
      {typeof children === "function" ? children(file, dragging) : children}
    </UploadContainer>
  );
};

export default Upload;
```

```jsx
{% raw %}
// Upload.stories.js
import Upload from ".";

export default {
  title: "Component/Upload",
  component: Upload,
};

export const Default = () => {
  return (
    <Upload>
      <button>Upload!</button>
    </Upload>
  );
};

export const AccessFile = () => {
  return (
    <Upload>
      {(file) => <button>{file ? file.name : "CLICK ME"}</button>}
    </Upload>
  );
};

export const Droppable = () => {
  return (
    <Upload droppable>
      {(file, dragging) => (
        <div
          style={{
            width: 300,
            height: 100,
            border: "4px dashed #aaa",
            borderColor: dragging ? "black" : "#aaa",
          }}
        >
          {file ? file.name : "Click or drag file to this area to upload"}
        </div>
      )}
    </Upload>
  );
};
{% endraw %}
```

<br><br>

- Badge

```jsx
// index.js
import styled from "@emotion/styled";

const BadgeContainer = styled.div`
  position: relative;
  display: inline-block;
`;

const Super = styled.sup`
  position: absolute;
  top: 0;
  right: 0;
  display: inline-flex;
  align-items: center;
  height: 20px;
  padding: 0 8px;
  font-size: 12px;
  border-radius: 20px;
  color: white;
  background-color: tomato;
  transform: translate(50%, -50%);

  &.dot {
    padding: 0;
    width: 6px;
    height: 6px;
    border-radius: 50%;
  }
`;

const Bedge = ({
  children,
  count,
  maxCount,
  showZero,
  dot = false,
  backgroundColor,
  textColor,
  ...props
}) => {
  const colorStyle = {
    backgroundColor,
    color: textColor,
  };

  let badge = null;
  if (count) {
    badge = (
      <Super style={colorStyle}>
        {maxCount && count > maxCount ? `${maxCount}+` : count}
      </Super>
    );
  } else {
    if (count !== undefined) {
      badge = showZero ? <Super style={colorStyle}>0</Super> : null;
    } else if (dot) {
      badge = <Super style={colorStyle} className="dot"></Super>;
    }
  }

  return (
    <BadgeContainer {...props}>
      {children}
      {badge}
    </BadgeContainer>
  );
};

export default Bedge;
```

```jsx
{% raw %}
// Badge.stories.js
import Bedge from ".";
import Image from "../Image";

export default {
  title: "Component/Bedge",
  component: Bedge,
  argTypes: {
    count: {
      defaultValue: 10,
      control: "number",
    },
    maxCount: {
      defaultValue: 100,
      control: "number",
    },
    backgroundColor: { control: "color" },
    textColor: { control: "color" },
    showZero: {
      defaultValue: false,
      control: "boolean",
    },
  },
};

export const Default = (args) => {
  return (
    <Bedge {...args}>
      <Image
        src="https://picsum.photos/60"
        width={60}
        style={{ borderRadius: 0 }}
      />
    </Bedge>
  );
};

export const Dot = () => {
  return (
    <Bedge dot>
      <Image
        src="https://picsum.photos/60"
        width={40}
        style={{ borderRadius: 0 }}
      />
    </Bedge>
  );
};
{% endraw %}
```

<br><br>

- Icon

```jsx
// index.js
import styled from "@emotion/styled";
import { Buffer } from "buffer";

const IconWrapper = styled.i`
  display: inline-block;
`;

const Icon = ({
  name,
  size = 16,
  strokeWidth = 2,
  rotate,
  color = "#222",
  ...props
}) => {
  const shapeStyle = {
    width: size,
    height: size,
    transform: rotate ? `rotate(${rotate}deg)` : undefined,
  };
  const iconStyle = {
    "stroke-width": strokeWidth,
    stroke: color,
    width: size,
    height: size,
  };
  const icon = require("feather-icons").icons[name];
  const svg = icon ? icon.toSvg(iconStyle) : "";
  const base64 = Buffer.from(svg, "utf8").toString("base64");

  return (
    <IconWrapper {...props} style={shapeStyle}>
      <img src={`data:image/svg+xml;base64,${base64}`} alt={name} />
    </IconWrapper>
  );
};

export default Icon;
```

```jsx
import Icon from ".";

export default {
  title: "Component/Icon",
  component: Icon,
  argTypes: {
    name: { defaultValue: "box", control: "text" },
    size: { defaultValue: 16, control: { type: "range", min: 16, max: 80 } },
    strokeWidth: {
      defaultValue: 2,
      control: { type: "range", min: 2, max: 6 },
    },
    color: {
      defaultValue: "#222",
      control: "color",
    },
    rotate: { defaultValue: 0, control: { type: "range", min: 0, max: 360 } },
  },
};

export const Default = (args) => {
  return <Icon {...args} />;
};
```

<br><br><br>

---

### ì¶œì²˜

[í”„ë¡œê·¸ë˜ë¨¸ìŠ¤](https://programmers.co.kr/)

[https://ko.reactjs.org/docs/context.html](https://ko.reactjs.org/docs/context.html)
