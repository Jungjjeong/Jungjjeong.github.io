---
layout: single
title: "[DAY-54] React (7)"
categories: [devCourse, TIL]
last_modified_at: 2022-06-02
excerpt: "ğŸ˜ŠTIL : ì‚¬ìš©ì ì •ì˜ Hook ì‹¤ìŠµ~ing.."
header:
  teaser: https://user-images.githubusercontent.com/72294509/171569076-8b648858-e5dc-4cf5-80f8-511e3f003d8a.png
---

![Untitled](https://user-images.githubusercontent.com/72294509/171569076-8b648858-e5dc-4cf5-80f8-511e3f003d8a.png){: .align-center}

> ğŸ˜‰ **í—·ê°ˆë ¸ë˜ & ëª°ëë˜ ë¶€ë¶„ë“¤ë§Œ ì •ë¦¬**í•˜ëŠ” ë‚˜ë§Œì˜ TIL<br>
> ğŸ˜¯ ëª¨ë“  ê°•ì˜ ë‚´ìš©ì€ ì ì§€ ì•Šì•„ìš”!

<p class='notice--success'>
	<strong>ì˜¤ëŠ˜ì˜ ì†Œê°ì€?</strong><br>
	ì˜¤ëŠ˜ë„ ì—´ì‹¬íˆ ì‚¬ìš©ì ì •ì˜ í›…ë“¤ì— ëŒ€í•´ ì‹¤ìŠµí–ˆë‹¤. <br>
	useIntervalê³¼ useTimeoutì€ Fn(í•¨ìˆ˜) íŒŒì¼ë“¤ì„ ë‚˜ëˆ„ì–´ ì‘ì„±í–ˆë‹¤.<br>
	ì°¨ì´ëŠ” ê°„ë‹¨í•˜ë‹¤. ì‹œì‘ì„ ëˆŒëŸ¬ì£¼ëŠëƒ ì»´í¬ë„ŒíŠ¸ê°€ ë¡œë“œë˜ìë§ˆì ì‹¤í–‰ë˜ëŠëƒ.<br>
	<br>
	useDebounceëŠ” í–¥í›„ ì œì‘í•  í”„ë¡œì íŠ¸ì—ì„œë„ êµ‰ì¥íˆ ìœ ìš©í•˜ê²Œ ì‚¬ìš©ë  ê²ƒ ê°™ë‹¤. <br>
	useIntervalì„ ì‚¬ìš©í•˜ë©´ ì“°ë¡œí‹€ë§ ë°©ì‹ë„ Hookìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ.
</p>

<br><br><br>

# [1] ì»´í¬ë„ŒíŠ¸ ì‹¤ìŠµ

## useResize

```jsx
// useResize.js
import { useEffect, useRef } from "react";

const useResize = (handler) => {
  const savedHandler = useRef(handler);
  const ref = useRef(null);

  useEffect(() => {
    savedHandler.current = handler;
  }, [handler]);

  useEffect(() => {
    const element = ref.current;
    if (!element) return;

    const observer = new ResizeObserver((entries) => {
      savedHandler.current(entries[0].contentRect);
    });

    observer.observe(element);

    return () => {
      observer.disconnect();
    };
  }, [ref]);

  return ref;
};

export default useResize;
```

```jsx
// useResize.stories.js
import styled from "@emotion/styled";
import { useState } from "react";
import Image from "../../components/_BasicComponent/Image";
import useResize from "../../hooks/useResize";

export default {
  title: "Hook/useResize",
};

const Background = styled.div`
  width: 100%;
  height: 400px;
  background-color: blue;
`;

export const Default = () => {
  const [imageSize, setImageSize] = useState({ width: 0, height: 0 });
  const ref = useResize((rect) => {
    setImageSize({ width: rect.width, height: rect.height });
  });

  return (
    <Background ref={ref}>
      <Image
        width={imageSize.width}
        height={imageSize.height}
        src="https://picsum.photos/1000"
        mode="contain"
      />
    </Background>
  );
};
```

<br><br>

## useLocalStorage, useSessionStorage

`LocalStorage`ì™€ `SessionStorage`ì´ìš© ë°©ë²•ì€ ë™ì¼í•˜ê¸°ì—, ì €ì¥ì†Œ ì´ë¦„ë§Œ ë°”ê¿”ì£¼ë©´ ëœë‹¤.

ë”°ë¼ì„œ ì½”ë“œëŠ” `useLocalStorage`ë§Œ ì²¨ë¶€í•œë‹¤.

<br>

```jsx
// useLocalStorage.js
import { useState } from "react";

const useLocalStorage = (key, initialValue) => {
  const [storedValue, setStoredValue] = useState(() => {
    try {
      const item = localStorage.getItem(key);
      return item ? JSON.parse(item) : initialValue;
    } catch (error) {
      console.error(error);
      return initialValue;
    }
  });

  const setValue = (value) => {
    try {
      const valueToStore =
        typeof value === "function" ? value(storedValue) : value;

      setStoredValue(valueToStore);
      localStorage.setItem(key, JSON.stringify(valueToStore));
    } catch (error) {
      console.error(error);
    }
  };

  return [storedValue, setValue];
};

export default useLocalStorage;
```

```jsx
// useLocalStorage.stories.js
import useLocalStorage from "../../hooks/useLocalStorage";

export default {
  title: "Hook/useLocalStoreage",
};

export const Default = () => {
  const [status, setStatus] = useLocalStorage("status", "404 NOT FOUND");

  return (
    <div>
      <button onClick={() => setStatus("200 OK")}>Resend</button>
      {status}
    </div>
  );
};
```

<br><br>

## useForm

ì •ê·œ í‘œí˜„ì‹ ì–´ë µë‹¤â€¦.

ë” ë³µì¡í•œ ì •ê·œ í‘œí˜„ì‹ì„ ì‚¬ìš©í•œë‹¤ëŠ”ë°, ì•Œì•„ë³´ê³  í”„ë¡œì íŠ¸ì—ì„œ ì ìš©í•´ë´ì•¼ê² ë‹¤.

<br>

```jsx
// useForm.js
import { useState } from "react";

const useForm = ({ initialValues, onSubmit, validate }) => {
  const [values, setValues] = useState(initialValues);
  const [errors, setErrors] = useState({});
  const [isLoading, setIsLoading] = useState(false);

  const handleChange = (e) => {
    const { name, value } = e.target;
    setValues({ ...values, [name]: value });
  };

  const handleSubmit = async (e) => {
    setIsLoading(true);
    e.preventDefault();

    const newErrors = validate(values);

    if (Object.keys(newErrors).length === 0) {
      await onSubmit(values);
    }

    setErrors(newErrors);
    setIsLoading(false);
  };

  return {
    values,
    errors,
    isLoading,
    handleChange,
    handleSubmit,
  };
};

export default useForm;
```

```jsx
// useForm.stories.js
import useForm from "../../hooks/useForm";

export default {
  title: "Hook/useForm",
};

const sleep = () => {
  return new Promise((resolve) => {
    setTimeout(() => resolve(), 1000);
  });
};

export const Default = () => {
  const { isLoading, errors, handleChange, handleSubmit } = useForm({
    initialValues: {
      email: "",
      password: "",
    },
    onSubmit: async (values) => {
      await sleep();
      alert(JSON.stringify(values));
    },
    validate: ({ email, password }) => {
      const errors = {};
      if (!email) errors.email = "ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.";
      if (!password) errors.password = "ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.";
      if (!/^.+@.+\..+$/.test(email))
        errors.email = "ì˜¬ë°”ë¥¸ ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.";

      return errors;
    },
  });
  return (
    <form onSubmit={handleSubmit}>
      <h1>Sign In</h1>
      <div>
        <input
          name="email"
          type="email"
          placeholder="email"
          onChange={handleChange}
        />
        {errors.email}
      </div>
      <div>
        <input
          name="password"
          type="password"
          placeholder="password"
          onChange={handleChange}
        />
        {errors.password}
      </div>
      <button type="submit" disabled={isLoading}>
        {isLoading ? "Loading..." : "Submit"}
      </button>
    </form>
  );
};
```

<br><br>

## useTimeout

`useTimeout`ì€ `useTimeoutFn`í›…ì„ ì‚¬ìš©í•œë‹¤.

<br>

```jsx
// useTimeoutFn.js
import { useRef, useEffect, useCallback } from "react";

const useTimeoutFn = (fn, ms) => {
  const timeoutId = useRef();
  const callback = useRef(fn);

  useEffect(() => {
    callback.current = fn;
  }, [fn]);

  const run = useCallback(() => {
    timeoutId.current && clearTimeout(timeoutId.current);

    timeoutId.current = setTimeout(() => {
      callback.current();
    }, ms);
  }, [ms]);

  const clear = useCallback(() => {
    timeoutId.current && clearTimeout(timeoutId.current);
  }, []);

  useEffect(() => clear, [clear]);

  return [run, clear];
};

export default useTimeoutFn;
```

```jsx
// useTimeout.js
import { useEffect } from "react";
import useTimeoutFn from "./useTimeoutFn";

const useTimeout = (fn, ms) => {
  const [run, clear] = useTimeoutFn(fn, ms);

  useEffect(() => {
    run();
    return clear;
  }, [run, clear]);

  return clear;
};

export default useTimeout;
```

```jsx
// useTimeoutFn.stories.js
import useTimeoutFn from "../../hooks/useTimeoutFn";

export default {
  title: "Hook/useTimeoutFn",
};

export const Default = () => {
  const [run, clear] = useTimeoutFn(() => {
    alert("ì‹¤í–‰");
  }, 3000);
  return (
    <>
      <div>useTimeoutFn Test</div>
      <button onClick={run}>3ì´ˆ ë’¤ ì‹¤í–‰</button>
      <button onClick={clear}>Stop</button>
    </>
  );
};
```

```jsx
// useTimeout.stories.js
import useTimeout from "../../hooks/useTimeout";

export default {
  title: "Hook/useTimeout",
};

export const Default = () => {
  const clear = useTimeout(() => {
    alert("ì‹¤í–‰");
  }, 3000);
  return (
    <>
      <div>useTimeout Test</div>
      <button onClick={clear}>Stop</button>
    </>
  );
};
```

<br><br>

## useInterval

`useInterval`ì€ `useIntervalFn`í›…ì„ ì‚¬ìš©í•œë‹¤.

<br>

```jsx
// useIntervalFn.js
import { useRef, useEffect, useCallback } from "react";

const useIntervalFn = (fn, ms) => {
  const intervalId = useRef();
  const callback = useRef(fn);

  useEffect(() => {
    callback.current = fn;
  }, [fn]);

  const run = useCallback(() => {
    intervalId.current && clearInterval(intervalId.current);

    intervalId.current = setInterval(() => {
      callback.current();
    }, ms);
  }, [ms]);

  const clear = useCallback(() => {
    intervalId.current && clearInterval(intervalId.current);
  }, []);

  useEffect(() => clear, [clear]);

  return [run, clear];
};

export default useIntervalFn;
```

```jsx
// useInterval.js
import { useEffect } from "react";
import useIntervalFn from "./useIntervalFn";

const useInterval = (fn, ms) => {
  const [run, clear] = useIntervalFn(fn, ms);

  useEffect(() => {
    run();

    return clear;
  }, [run, clear]);

  return clear;
};

export default useInterval;
```

```jsx
// useIntervalFn.stories.js
import { useState } from "react";
import useIntervalFn from "../../hooks/useIntervalFn";

export default {
  title: "Hook/useIntervalFn",
};

export const Default = () => {
  const [array, setArray] = useState([]);
  const [run, clear] = useIntervalFn(() => {
    setArray([...array, "Plus"]);
  }, 1000);

  return (
    <>
      <div>useIntervalFn Test</div>
      <div>{array}</div>
      <button onClick={run}>1ì´ˆë§ˆë‹¤ ì¶”ê°€!</button>
      <button onClick={clear}>Clear</button>
    </>
  );
};
```

```jsx
// useInterval.stories.js
import { useState } from "react";
import useInterval from "../../hooks/useInterval";

export default {
  title: "Hook/useInterval",
};

export const Default = () => {
  const [array, setArray] = useState([]);
  const clear = useInterval(() => {
    setArray([...array, "Plus"]);
  }, 1000);

  return (
    <>
      <div>useInterval Test</div>
      <div>{array}</div>
      <button onClick={clear}>Clear</button>
    </>
  );
};
```

<br><br>

## useDebounce

eslintê²½ê³ ê°€ ë– ì„œ disactive ì£¼ì„ì„ ë„£ì–´ë²„ë ¸ë‹¤.

<br>

```jsx
// useDebounce.js
import { useEffect } from "react";
import useTimeoutFn from "./useTimeoutFn";

const useDebounce = (fn, ms, deps) => {
  const [run, clear] = useTimeoutFn(fn, ms);

  // eslint-disable-next-line react-hooks/exhaustive-deps
  useEffect(run, deps);

  return clear;
};

export default useDebounce;
```

```jsx
// useDebounce.stories.js
import { Fragment, useState } from "react";
import useDebounce from "../../hooks/useDebounce";

export default {
  title: "Hook/useDebounce",
};

const companies = ["Kakao", "Naver", "Coupang", "Line", "Woowahan"];

export const Default = () => {
  const [value, setValue] = useState("");
  const [result, setResult] = useState([]);

  useDebounce(
    () => {
      if (value === "") setResult([]);
      else {
        setResult(
          companies.filter((company) =>
            company.toLowerCase().includes(value.toLowerCase())
          )
        );
      }
    },
    300,
    [value]
  );

  return (
    <div>
      <input
        type="text"
        value={value}
        onChange={(e) => setValue(e.target.value)}
      />
      <div>
        {result.map((item) => (
          <Fragment key={item}>
            {item}
            <br />
          </Fragment>
        ))}
      </div>
    </div>
  );
};
```

<br><br><br>

---

### ì¶œì²˜

[í”„ë¡œê·¸ë˜ë¨¸ìŠ¤](https://programmers.co.kr/)
